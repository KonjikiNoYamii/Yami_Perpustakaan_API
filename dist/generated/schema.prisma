model Book {
  id String @id @default(uuid())

  // Informasi utama buku
  nama      String
  deskripsi String
  harga     Int
  stok      Int
  coverUrl  String?

  // üìÖ Properti untuk evaluasi (PENTING)
  tahunTerbit Int // ‚Üê untuk filter rentang tahun
  penulis     String
  penerbit    String
  isbn        String? @unique

  // Relasi kategori
  categoryId String
  category   Category @relation(fields: [categoryId], references: [id])

  // Relasi peminjaman
  loanItems LoanItem[]

  // Metadata
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
}

model Category {
  id   String @id @default(uuid())
  nama String @unique

  books Book[]

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
}

model Loan {
  id String @id @default(uuid())

  userId String
  user   User   @relation(fields: [userId], references: [id])

  status String @default("BORROWED")
  // "BORROWED" | "RETURNED"

  items LoanItem[]

  tanggalPinjam  DateTime  @default(now())
  tanggalKembali DateTime?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
}

model LoanItem {
  id String @id @default(uuid())

  loanId String
  loan   Loan   @relation(fields: [loanId], references: [id])

  bookId String
  book   Book   @relation(fields: [bookId], references: [id])

  qty Int
}

model User {
  id       String @id @default(uuid())
  nama     String
  email    String @unique
  password String
  kota     String
  role     String

  loans Loan[]

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
}

generator client {
  provider = "prisma-client-js"
  output   = "../generated"
}

datasource db {
  provider = "postgresql"
}
